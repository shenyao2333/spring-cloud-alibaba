package com.sy.spring.cloud.alibaba.provider.basic.utils;

import lombok.extern.slf4j.Slf4j;

import javax.mail.*;
import javax.mail.internet.*;
import java.util.Properties;

/**
 * @author sy
 * @date Created in 2020.4.4 23:48
 * @description 发送邮箱工具类
 */
@Slf4j
public class SendEmailUtil {


    /**
     * 发件人邮箱地址
     */
    private static String from = "sy91aa@163.com";
    /**
     * 发件人称号，同邮箱地址
     */
    private static String user = "sy91aa@163.com";
    /**
     * 发件人邮箱客户端授权码
     */
    private static String password = "shenyao1995";
    /**
     * 发件人的邮箱服务器
     */
    private static String mailHost = "smtp.163.com";


    private static String register = "<div id=\"contentDiv\" onmouseover=\"getTop().stopPropagation(event);\" onclick=\"getTop().preSwapLink(event, 'spam', 'ZC2305-Zg5y4ZYhbWrif0EfcJkoEa4');\" style=\"position:relative;font-size:14px;height:auto;padding:15px 15px 10px 15px;z-index:1;zoom:1;line-height:1.7;\" class=\"body\">    <div id=\"qm_con_body\"><div id=\"mailContentContainer\" class=\"qmbox qm_con_body_content qqmail_webmail_only\" style=\"\"><div class=\"preview-content\"><div class=\"content-wrap\" style=\"margin: 0px auto; overflow: hidden; padding: 0px; border: 0px dotted rgb(238, 238, 238); width: 600px;\"><div class=\"full\" tindex=\"1\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td style=\"direction: ltr; width: 600px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top;\"><div style=\"display: inline-block; vertical-align: top; width: 100%;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" width=\"100%\" style=\"vertical-align: top;\"><tbody><tr><td style=\"font-size: 0px; word-break: break-word; width: 550px; text-align: center; padding: 0px 25px;\"><div><a href=\"https://www.jianguoyun.com\" style=\"font-size: 0px;\" rel=\"noopener\" target=\"_blank\"><img height=\"auto\" width=\"32\" src=\"javascript:;\" style=\"box-sizing: border-box; border: 0px; display: inline-block; outline: none; text-decoration: none; height: auto; max-width: 100%; padding: 0px;\"></a></div></td></tr></tbody></table></div></td></tr></tbody></table></div><div tindex=\"2\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: rgb(255, 255, 255); background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 1% 50%;\"><tbody><tr><td style=\"direction: ltr; font-size: 0px; text-align: center; vertical-align: top; width: 600px;\"><table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align: top;\"><tbody><tr><td style=\"width: 100%; max-width: 100%; min-height: 1px; font-size: 13px; text-align: left; direction: ltr; vertical-align: top; padding: 0px;\"><div class=\"full\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td style=\"direction: ltr; width: 600px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top; background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" width=\"100%\" style=\"vertical-align: top;\"><tbody><tr><td align=\"left\" style=\"font-size: 0px; padding: 2px 0px;\"><div class=\"text\" style=\"font-family: 微软雅黑, Microsoft YaHei; overflow-wrap: break-word; margin: 0px; text-align: center; line-height: 20px; color: rgb(102, 102, 102); font-size: 13px; font-weight: normal;\"><div><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 13px; margin: 0px;\"><span style=\"color: rgb(136, 136, 136);\">Nutstore</span></p></div></div></td></tr></tbody></table></td></tr></tbody></table></div></td></tr></tbody></table></td></tr></tbody></table></div><div class=\"full\" tindex=\"3\" style=\"margin: 0px auto; line-height: 0px; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td align=\"center\" style=\"direction: ltr; font-size: 0px; padding: 13px 0px; text-align: center; vertical-align: top; word-break: break-word; width: 600px; background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse: collapse; border-spacing: 0px;\"><tbody><tr><td style=\"width: 504px; border-top: 1px solid rgb(204, 204, 204);\"></td></tr></tbody></table></td></tr></tbody></table></div><div class=\"full\" tindex=\"4\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td style=\"direction: ltr; width: 600px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top; background-color: rgb(255, 255, 255); background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" width=\"100%\" style=\"vertical-align: top;\"><tbody><tr><td align=\"left\" style=\"font-size: 0px; padding: 20px;\"><div class=\"text\" style=\"font-family: 微软雅黑, Microsoft YaHei; overflow-wrap: break-word; margin: 0px; text-align: left; line-height: 20px; color: rgb(0, 0, 0); font-size: 22px; font-weight: normal;\"><div><h3 style=\"line-height: 24px; font-size: 1.17em; font-weight: bold; margin: 0px;\"><strong>感谢您对超超商城的支持和信任</strong></h3></div></div></td></tr></tbody></table></td></tr></tbody></table></div><div class=\"full\" tindex=\"5\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td style=\"direction: ltr; width: 600px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top; background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" width=\"100%\" style=\"vertical-align: top;\"><tbody><tr><td align=\"left\" style=\"font-size: 0px; padding: 20px;\"><div class=\"text\" style=\"font-family: 微软雅黑, Microsoft YaHei; overflow-wrap: break-word; margin: 0px; text-align: left; line-height: 20px; color: rgb(0, 0, 0); font-size: 14px; font-weight: normal;\"><div><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 14px; margin: 0px;\"><br></p><h3 style=\"line-height: 24px; font-size: 1.17em; font-weight: bold; margin: 0px;\">一个邮箱只能绑定一个账户，请小心使用</h3><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 14px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 14px; margin: 0px;\"><span style=\"color: rgb(0, 0, 0);\">您的 注册码如下，请查收：</span></p></div></div></td></tr></tbody></table></td></tr></tbody></table></div><div class=\"full\" tindex=\"6\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td style=\"direction: ltr; width: 600px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top; background-color: rgb(255, 200, 0); background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" width=\"100%\" style=\"vertical-align: top;\"><tbody><tr><td align=\"left\" style=\"font-size: 0px; padding: 20px;\"><div class=\"text\" style=\"font-family: 微软雅黑, Microsoft YaHei; overflow-wrap: break-word; margin: 0px; text-align: left; line-height: 20px; color: rgb(102, 102, 102); font-size: 18px; font-weight: normal;\"><div><h3 style=\"line-height: 24px; font-size: 1.17em; font-weight: bold; margin: 0px;\">此次注册码为：{code}</h3></div></div></td></tr></tbody></table></td></tr></tbody></table></div><div class=\"full\" tindex=\"7\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td style=\"direction: ltr; width: 600px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top; background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" width=\"100%\" style=\"vertical-align: top;\"><tbody><tr><td align=\"left\" style=\"font-size: 0px; padding: 20px;\"><div class=\"text\" style=\"font-family: 微软雅黑, Microsoft YaHei; overflow-wrap: break-word; margin: 0px; text-align: left; line-height: 20px; color: rgb(0, 0, 0); font-size: 12px; font-weight: normal;\"><div><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\">————</p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\">▶ 超超商城官网信息：超超未来的趋势是什么？</p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\">▶ 了解超超商城可以做什么：<a href=\"http://www.baidu.com\" rel=\"noopener\" target=\"_blank\" style=\"text-decoration: underline; font-weight: normal;\">超超商城是为什么出现的呢？</a></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\">▶ <span style=\"color: black;\">如果您还没有下载超超APP，请 </span><a href=\"https://www.jianguoyun.com/s/downloads\" rel=\"noopener\" target=\"_blank\" style=\"color: rgb(0, 71, 178); text-decoration: underline; font-weight: normal;\">点击这里</a><span style=\"color: black;\">下载安装客户端</span></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\">▶ <span style=\"color: black;\">如果您有其他使用上的问题，欢迎联系我们：<a href=\"mailto:sy91aa@163.com\" rel=\"noopener\" target=\"_blank\">sy91aa@163.c<wbr>om</a></span></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><br></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><span style=\"color: black;\">感谢您的支持！ &nbsp;</span></p><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\">——超超团队</p></div></div></td></tr></tbody></table></td></tr></tbody></table></div><div tindex=\"8\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: rgb(255, 255, 255); background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 1% 50%;\"><tbody><tr><td style=\"direction: ltr; font-size: 0px; text-align: center; vertical-align: top; width: 600px;\"><table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align: top;\"><tbody><tr><td style=\"width: 100%; max-width: 100%; min-height: 1px; font-size: 13px; text-align: left; direction: ltr; vertical-align: top; padding: 0px;\"></td></tr></tbody></table></td></tr></tbody></table></div><div class=\"full\" tindex=\"9\" style=\"margin: 0px auto; line-height: 0px; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td align=\"center\" style=\"direction: ltr; font-size: 0px; padding: 7px 0px; text-align: center; vertical-align: top; word-break: break-word; width: 600px; background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse: collapse; border-spacing: 0px;\"><tbody><tr><td style=\"width: 507px; border-top: 1px solid rgb(204, 204, 204);\"></td></tr></tbody></table></td></tr></tbody></table></div><div tindex=\"10\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: rgb(255, 255, 255); background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 1% 50%;\"><tbody><tr><td style=\"direction: ltr; font-size: 0px; text-align: center; vertical-align: top; width: 600px;\"><table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"vertical-align: top;\"><tbody><tr><td style=\"width: 100%; max-width: 100%; min-height: 1px; font-size: 13px; text-align: left; direction: ltr; vertical-align: top; padding: 0px;\"><div class=\"full\" style=\"margin: 0px auto; max-width: 600px;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width: 600px;\"><tbody><tr><td style=\"direction: ltr; width: 600px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top; background-image: url(); background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" width=\"100%\" style=\"vertical-align: top;\"><tbody><tr><td align=\"left\" style=\"font-size: 0px; padding: 0px 20px;\"><div class=\"text\" style=\"font-family: 微软雅黑, Microsoft YaHei; overflow-wrap: break-word; margin: 0px; text-align: center; line-height: 20px; color: rgb(102, 102, 102); font-size: 12px; font-weight: normal;\"><div><p style=\"text-size-adjust: none; word-break: break-word; line-height: 20px; font-size: 12px; margin: 0px;\"><span style=\"color: rgb(150, 150, 150);\">如有任何疑问，请</span><a href=\"https://aliyun.com/index.htm?tntInstId=_14Lmqci&amp;scene=SCE00003192#/\" rel=\"noopener\" target=\"_blank\" style=\"color: rgb(17, 85, 204); text-decoration: underline; font-weight: normal;\">联系我们的支持团队</a></p></div></div></td></tr></tbody></table></td></tr></tbody></table></div></td></tr></tbody></table></td></tr></tbody></table></div></div></div>\n" +
            "<style type=\"text/css\">.qmbox style, .qmbox script, .qmbox head, .qmbox link, .qmbox meta {display: none !important;}</style></div></div><!-- --><style>#mailContentContainer .txt {height:auto;}</style>  </div>";



    public static void doSendRegister(String sendEmail,String code){
        sendMail(sendEmail,"超超商城",register.replace("{code}",code));
    }


    /**
     *
     * @param to 接收人邮箱
     * @param text 发送内容
     * @param title 发送标题
     * @return
     */
    public static boolean sendMail(String to, String title , String text) {
        Properties props = new Properties();
        props.setProperty("mail.smtp.host", mailHost);
        props.setProperty("mail.smtp.auth", "true");
        props.setProperty("mail.smtp.port", "465");
        props.setProperty("mail.smtp.socketFactory.port", "465");
        props.setProperty("mail.smtp.socketFactory.fallback", "false");
        props.setProperty("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
        Session session = Session.getDefaultInstance(props);
        MimeMessage message = new MimeMessage(session);
        try {
            message.setFrom(new InternetAddress(from));
            message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));
            message.setSubject(title);
            Multipart multipart = new MimeMultipart();
            BodyPart contentPart = new MimeBodyPart();
            contentPart.setContent(text, "text/html;charset=utf-8");
            multipart.addBodyPart(contentPart);
            message.setContent(multipart);
            message.saveChanges(); // 保存变化
            Transport transport = session.getTransport("smtp");
            transport.connect(mailHost, user, password);
            transport.sendMessage(message, message.getAllRecipients());
            transport.close();
        } catch (Exception e) {
            e.printStackTrace();
            log.error("发送失败了");
        }
        return true;
    }

}
